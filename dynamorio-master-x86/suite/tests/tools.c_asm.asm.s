


































































































































































































































































































































































































































































































































































































































































































































































































   

























































  



  





















   




  




































































































































































































































































































































































































































































































































































































































































































































































































.686 
.XMM 
.MODEL flat, c 
ASSUME fs:_DATA 
.CODE




        code_self_mod PROC


        mov      ecx, dword ptr [ 1*4 + esp]
        call     next_instr
      next_instr:
        pop      edx
    



        mov      dword ptr [edx + 5], ecx 
        mov      eax,012345678h 
        mov      ecx,0 
      repeat1:
        dec      eax
        inc      ecx
        cmp      eax,0
        jnz      repeat1
        mov      eax,ecx
        ret



















































        code_self_mod ENDP



        code_inc PROC

        mov      eax, dword ptr [ 1*4 + esp]
        inc eax
        ret
        code_inc ENDP



        code_dec PROC

        mov      eax, dword ptr [ 1*4 + esp]
        dec eax
        ret
        code_dec ENDP



        dummy PROC

        mov      eax, 01h
        ret
        dummy ENDP



        call_with_retaddr PROC


        lea      eax, [esp]  
        xchg     eax, dword ptr [ 1*4 + esp]       
        jmp      eax             


















        call_with_retaddr ENDP



        tailcall_with_retaddr PROC


        mov      eax, [esp]  
        xchg     eax, dword ptr [ 1*4 + esp]       
        jmp      eax             











        tailcall_with_retaddr ENDP























END



