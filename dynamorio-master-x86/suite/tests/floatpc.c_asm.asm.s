



























































































































































































































































































































































































   

























































  



  





















   




  



































































































































































































































































































































































































































































































































































































































































































































































































.686 
.XMM 
.MODEL flat, c 
ASSUME fs:_DATA 
.CODE









        test_fnstenv_intra PROC

        mov      eax, dword ptr [ 1*4 + esp]
        lea      edx, [fldz_addr]
        mov      dword ptr [eax], edx
fldz_addr::
        fldz
        sub      esp, 32 
        fnstenv  [esp]
        mov      eax, dword ptr [esp + 12] 
        add      esp, 32
        ret
        test_fnstenv_intra ENDP



        test_fnstenv_inter PROC

        mov      eax, dword ptr [ 1*4 + esp]
        lea      edx, [fldz_addr1]
        mov      dword ptr [eax], edx
fldz_addr1::
        fldz
        
        mov      eax, 1
        cmp      eax, 1
        jne      skip
        sub      esp, 32 
        fnstenv  [esp]
        mov      eax, dword ptr [esp + 12] 
        add      esp, 32
skip:
        ret
        test_fnstenv_inter ENDP



















































        test_fxsave_intra PROC

        
        mov      eax, dword ptr [ 1*4 + esp]
        lea      edx, [fldz_addr2]
        mov      dword ptr [eax], edx
fldz_addr2::
        fldz
        mov      edx, esp
        sub      esp, 512+16 
        and      esp, -16    
        fxsave   [esp]
        mov      eax, dword ptr [esp + 8]
        mov      esp, edx
        ret
        test_fxsave_intra ENDP



        test_fxsave_inter PROC

        
        mov      eax, dword ptr [ 1*4 + esp]
        lea      edx, [fldz_addr3]
        mov      dword ptr [eax], edx
fldz_addr3::
        fldz
        
        mov      eax, 1
        cmp      eax, 1
        jne      skip1
        mov      edx, esp
        sub      esp, 512+16 
        and      esp, -16    
        fxsave   [esp]
        mov      eax, dword ptr [esp + 8]
        mov      esp, edx
skip1:
        ret
        test_fxsave_inter ENDP


END


