


























































































































































































































































































































   

























































  



  





















   




  


































































































































































































































































































































































































































































































































































































































































































































































































.686 
.XMM 
.MODEL flat, c 
ASSUME fs:_DATA 
.CODE






EXTERN FreeLibrary@4:PROC
EXTERN process_attach:PROC




    




























        DllMain@12 PROC

        cmp      dword ptr [ 2*4 + esp], 1
        jne      DllMain_not_pattach




         
 call process_attach 
 
        cmp      al, 0
        je       do_not_unload







        



        
        mov      eax, [esp]
        mov      [8 + esp], eax
        
        mov      eax, [4 + esp]
        mov      [12 + esp], eax
        
        add      esp, 8

        jmp      FreeLibrary@4

do_not_unload:
        



        mov      eax, 0





        ret      00ch


DllMain_not_pattach:
        mov      eax, 1



        ret      00ch

        DllMain@12 ENDP


END
